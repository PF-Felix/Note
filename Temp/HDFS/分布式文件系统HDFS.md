# 进度

看到了 53节 3分38秒。

# hadoop项目有哪些

![](Pasted%20image%2020231220192237.png)

hadoop 项目包含哪些？
上面的四个。

下面的是相关的项目。

# 批计算与流计算

阿里的 flink 是流计算，比批计算更牛。

# 大数据生态

![](Pasted%20image%2020231220192639.png)

# 开始


![zoom=40](Pasted%20image%2020231219171427.png)

![zoom=40](Pasted%20image%2020231219171438.png)

HDFS能够更好的支持分布式计算。

# 存储模型

![zoom=40](Pasted%20image%2020231219171447.png)

问题：一个完整的单词或者汉字的一个字拆分到不同的 block 中？怎么办？存储层不解决，在计算层解决。

为什么文件不支持修改？
- 如果支持修改，文件的修改会大量浪费集群的CPU和内存。
- 但是我们是想让这个集群更多的用来做计算的。
- 所以设计者做了折中。为了更好的支持计算，不允许修改文件
- 这也回答了上面的问题：分布式文件系统这么多，为什么hadoop还要开发一个分布式文件系统

# 架构设计

![zoom=40](Pasted%20image%2020231219171501.png)

NameNode 和 DataNodes
- HDFS 具有主/从架构。
- HDFS 集群的主服务器被称为 NameNode，是单个的，用于管理文件系统命名空间并控制客户端对文件的访问。
- 此外还有许多 DataNode，通常集群中的每个节点一个，用于管理连接到运行它们的节点的存储。
- HDFS 公开文件系统命名空间，并允许用户数据存储在文件中。在内部，文件被拆分为一个或多个块，这些块存储在一组 DataNode 中。
- NameNode 执行文件系统命名空间操作，例如打开、关闭和重命名文件和目录。它还确定块到 DataNode 的映射。DataNode 负责处理来自文件系统客户端的读取和写入请求。DataNode 还根据 NameNode 的指令执行区块创建、删除和复制。
- 集群中单个NameNode的存在，大大简化了系统的架构。
- NameNode 是所有 HDFS 元数据的仲裁者和存储库。该系统的设计方式是用户数据永远不会流经NameNode。 #待办事项 

架构图：
角色即进程
![zoom=60](Pasted%20image%2020231220030529.png)


![zoom=40](Pasted%20image%2020231219171507.png)

# 副本放置策略

![zoom=40](Pasted%20image%2020231219171533.png)

# 写流程

![zoom=40](Pasted%20image%2020231219171709.png)
这点很重要 流式计算也是变种的并行。
副本放置策略也值钱。

过了很长时间 NN 收不到 DN 就会再创建一个 DN

![zoom=40](Pasted%20image%2020231219171716.png)

# 读流程

读流程看上去很简单，其实并不简单。

![zoom=40](Pasted%20image%2020231221191555.png)

![zoom=40](Pasted%20image%2020231219171731.png)

# 搭建与安装

![zoom=40](Pasted%20image%2020231222101708.png)

![zoom=40](Pasted%20image%2020231219171737.png)

# 高可用

高可用解决方案
![zoom=40](Pasted%20image%2020231219171751.png)

![zoom=40](Pasted%20image%2020231219181323.png)

下面这节课非常重要。
![zoom=40](Pasted%20image%2020231219192454.png)

下面这些都是不用再看的。最后一节回顾也不用看。
![zoom=40](Pasted%20image%2020231219195029.png)


文件系统目录
HDFS支持文件系统分层组织
NameNode 维护文件系统命名空间。对文件系统命名空间或其属性的任何更改都由 NameNode 记录。应用程序可以指定应由 HDFS 维护的文件副本数。文件的副本数称为该文件的复制因子。此信息由 NameNode 存储。

# 其他

注意主备和主从的区别

nn数据同步 同步方式  数据强一致性会破坏可用性
nn就是为了高可用  因此这种不合适
如果异步。等于数据没有备份成功。会丢数据

nn存储到jn过半就算成功

还有个问题。nn谁是主谁是备？客户端和谁交互？
jn是做分布式存储的
zkfc和nn是同主机的  利用zk的分布式锁机制实现

扩展: zk事件回调比轮训的优点：实时触发

jnode 是推荐使用的，不推荐使用 NFS
> 白色：表示对象尚未被垃圾收集器访问过；可达性分析开始时所有对象都是白色，结束时白色对象代表不可达
> 灰色：表示对象已经被垃圾收集器访问过，但这个对象上至少存在一个引用还没有被扫描过
> 黑色：表示对象已经被垃圾收集器访问过，且这个对象的所有引用都已经扫描过，是安全存活的；如果有其他对象的引用指向黑色对象，无须重新扫描

**标记过程**

1. 可达性分析开始时，所有对象都是白色
2. 将 GCRoots 直接引用到的对象标记为灰色
3. 遍历所有灰色对象
    1. 将本对象引用到的其他对象全部标记为灰色
    2. 将本对象标记为黑色
4. 重复步骤3直到没有灰色对象时结束
5. 可达性分析结束后，白色对象是不可达对象，可以进行回收

**多标**
在并发标记阶段，标记过可达对象之后，如果这个对象重新变为不可达，就成为浮动垃圾，将在下一轮 GC 回收

**漏标**
漏标需要同时满足两个条件

> 灰色对象删除了指向白色对象的引用
> 黑色对象重新引用了该白色对象

漏标将导致可达对象被当成垃圾回收，有两种解决方案，CMS使用增量更新，G1使用原始快照
~~增量更新~~当黑色对象增加这个引用时后，记录这个引用，等并发标记结束后，再以引用中的黑色对象为根重新标记一次；用卡表记录卡片变为脏卡，利用写屏障先增加引用再记录新增的引用
~~原始快照（STAB）~~当灰色对象删除这个引用前，记录这个引用，等并发标记结束后，再以引用中的灰色对象为根重新标记一次（白色对象可能变为浮动垃圾）；利用写屏障，先记录引用再删除引用
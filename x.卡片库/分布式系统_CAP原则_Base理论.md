# CAP原则

![zoom=50](f53a999fb23176440d1ef1afad0b0139.png)

**一致性**
分布式系统中的所有数据备份在同一时刻是否是同样的值
1、如果某个节点更新了数据，其他节点如果都能读取到这个最新的数据就称为强一致
2、如果有某个节点没有读取到就是不一致
3、之后能读取到的话就是最终一致（BASE理论）

**可用性**
集群中一部分节点故障后，集群整体是否还能响应客户端的请求（有数据就行，不管它对不对）

**分区容忍性**
系统中任意信息的丢失或失败不会影响系统的继续运作

CAP三个指标三者不可得兼，只能三选二

# BASE理论

BASE 是这三个短语的缩写
**Basically Available**（基本可用）（允许损失部分可用性，但绝不是不可用）
**Soft state**（软状态）（允许请求与数据同步成功之间存在中间状态）
**Eventually consistent**（最终一致性）

其核心思想就是：即使无法做到强一致，应该采用适当的方式达到最终一致性

# 详细解释与举例

**CAP三个指标三者不可得兼，只能三选二**

~~P是必须满足的~~

举例说明：如果选择了 CA 放弃了 P，当发生分区现象时，为了保证一致性必须拒绝请求，但是 A 又不允许；因此 P 是必须满足的

如何保证P？做数据冗余，例如 mysql、redis、zookeeper

~~为什么不能同时满足CA？~~

假设用户向服务1 发送了写请求更改了数据，由于网络断开，这个更新同步不到服务2
此时如果又有一个读请求发给了服务2
1、读取成功但是读到的不是最新数据（不满足一致性）
2、阻塞等待直到网络恢复，服务2 数据得到同步之后再返回给用户（不满足可用性）

~~CP、AP 如何取舍？~~

看业务的容忍度

不错的策略是保证 AP 兼顾C（舍弃强一致，保证最终一致）

-----

#分布式 